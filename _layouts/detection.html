---
layout: base
---
<section class="page-section">
  <div class="container detection-container">
    <article class="detection-doc">
      <header class="detection-header">
        <div>
          <span class="status-pill status-pill--{{ page.status | default: 'preview' | downcase }}">{{ page.status | default: 'Preview' | capitalize }}</span>
          <h1>{{ page.title }}</h1>
          {% if page.summary %}
            <p class="detection-summary">{{ page.summary }}</p>
          {% endif %}
        </div>
        <div class="detection-meta-top">
          <span class="meta-label">Last updated</span>
          <span class="meta-value">{{ page.last_updated | date: "%b %d, %Y" }}</span>
        </div>
      </header>

      <section class="meta-grid">
        {% if page.id %}
          <div>
            <span class="meta-label">Detection ID</span>
            <span class="meta-value">{{ page.id }}</span>
          </div>
        {% endif %}
        {% if page.product %}
          <div>
            <span class="meta-label">Product</span>
            <span class="meta-value">{{ page.product }}</span>
          </div>
        {% endif %}
        {% if page.data_sources %}
          <div>
            <span class="meta-label">Data sources</span>
            <span class="meta-value">{{ page.data_sources | array_to_sentence_string }}</span>
          </div>
        {% endif %}
        {% if page.mitre %}
          <div>
            <span class="meta-label">ATT&amp;CK</span>
            <span class="meta-value">
              {{ page.mitre.tactic }} · {{ page.mitre.tactic_name }}<br />
              {{ page.mitre.technique }}{% if page.mitre.subtechnique %}.{{ page.mitre.subtechnique }}{% endif %} · {{ page.mitre.technique_name }}
            </span>
          </div>
        {% endif %}
        {% if page.severity %}
          <div>
            <span class="meta-label">Severity</span>
            <span class="meta-value">{{ page.severity | capitalize }}</span>
          </div>
        {% endif %}
        {% if page.author %}
          <div>
            <span class="meta-label">Author</span>
            <span class="meta-value">{{ page.author }}</span>
          </div>
        {% endif %}
      </section>

      {% if page.downloads %}
        <section class="downloads-bar">
          {% for download in page.downloads %}
            <a class="btn btn--ghost" href="{{ download.url | relative_url }}" target="_blank" rel="noopener">
              {{ download.label }}
            </a>
          {% endfor %}
        </section>
      {% endif %}

      {% if page.query %}
        <section class="code-box" data-code-block>
          <header class="code-box__header">
            <span>{{ page.query_language | default: 'Query' }}</span>
            <div class="code-box__actions">
              <button class="btn-icon" type="button" data-copy-btn data-copy-source="detection-query">Copy</button>
              <button class="btn-icon" type="button" data-wrap-toggle data-wrap-target="detection-query">Toggle wrap</button>
            </div>
          </header>
          <pre class="code-pre" id="detection-query" data-language="{{ page.query_language | default: 'SPL' }}"><code>{{ page.query | escape }}</code></pre>
        </section>
      {% endif %}

      <section class="detection-body">
        {{ content }}
      </section>

      {% if page.how_it_works %}
        <section class="detection-accordion" data-accordion>
          <button class="accordion-toggle" type="button">
            <span>How it works</span>
            <span class="icon">+</span>
          </button>
          <div class="accordion-panel">
            {{ page.how_it_works | markdownify }}
          </div>
        </section>
      {% endif %}

      {% if page.tuning_notes %}
        <section class="detection-accordion" data-accordion>
          <button class="accordion-toggle" type="button">
            <span>Tuning &amp; false-positive notes</span>
            <span class="icon">+</span>
          </button>
          <div class="accordion-panel">
            {{ page.tuning_notes | markdownify }}
          </div>
        </section>
      {% endif %}

      {% if page.related %}
        <section class="related-detections">
          <h2>Related detections</h2>
          <div class="card-grid">
            {% for slug in page.related %}
              {% assign related_det = site.detections | where: "slug", slug | first %}
              {% if related_det %}
                <article class="card">
                  <div class="card-body">
                    <p class="card-eyebrow">{{ related_det.mitre.tactic_name }} · {{ related_det.severity | capitalize }}</p>
                    <h3 class="card-title">
                      <a href="{{ related_det.url | relative_url }}">{{ related_det.title }}</a>
                    </h3>
                    <p class="card-summary">{{ related_det.summary }}</p>
                  </div>
                  <footer class="card-footer">
                    <span>Updated {{ related_det.last_updated | date: "%b %d, %Y" }}</span>
                    <a class="text-link" href="{{ related_det.url | relative_url }}">Read detection →</a>
                  </footer>
                </article>
              {% endif %}
            {% endfor %}
          </div>
        </section>
      {% endif %}
    </article>
  </div>
</section>
