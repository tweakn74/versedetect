(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[547],{63:(e,t,r)=>{"use strict";var a=r(7260);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},2821:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=function(){for(var e,t,r=0,a="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=function e(t){var r,a,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t)if(Array.isArray(t)){var o=t.length;for(r=0;r<o;r++)t[r]&&(a=e(t[r]))&&(s&&(s+=" "),s+=a)}else for(a in t)t[a]&&(s&&(s+=" "),s+=a);return s}(e))&&(a&&(a+=" "),a+=t);return a}},3602:(e,t,r)=>{"use strict";r.d(t,{DetectionExplorer:()=>n});var a=r(5155),s=r(2115),o=r(63),c=r(9683);let l={search:"",tactic:"",technique:"",product:"",dataSource:"",severity:"",status:""};function n(e){let{initialData:t}=e,r=(0,o.useRouter)(),n=(0,o.usePathname)(),[u,d]=(0,s.useTransition)(),[m,h]=(0,s.useState)(t),[x,p]=(0,s.useState)(l);(0,s.useEffect)(()=>{let e=!0;return(async()=>{try{var t;let r=(t="/versedetect",void 0!==t)?t:"",a=await fetch("".concat(r,"/detections.index.json"),{cache:"no-store"});if(!a.ok)throw Error("Failed to load detection index (".concat(a.status,")"));let s=await a.json();e&&h(s)}catch(e){console.error(e)}})(),()=>{e=!1}},[]),(0,s.useEffect)(()=>{let e=new URLSearchParams(window.location.search),t=t=>{var r;return null!=(r=e.get(t))?r:""};p(e=>({...e,search:t("search"),tactic:t("tactic"),technique:t("technique"),product:t("product"),dataSource:t("dataSource"),severity:t("severity"),status:t("status")}))},[]),(0,s.useEffect)(()=>{let e=new URLSearchParams;Object.entries(x).forEach(t=>{let[r,a]=t;a&&e.set(r,a)}),d(()=>{r.replace(e.size?"".concat(n,"?").concat(e.toString()):n,{scroll:!1})})},[x,n,r]);let v=(0,s.useMemo)(()=>{let e=new Map,t=new Map,r=new Set,a=new Set,s=new Set,o=new Set;m.forEach(c=>{if(c.mitre){let r=c.mitre.tactic_name?"".concat(c.mitre.tactic," \xb7 ").concat(c.mitre.tactic_name):c.mitre.tactic;e.set(c.mitre.tactic,r);let a=c.mitre.subtechnique?"".concat(c.mitre.technique,".").concat(c.mitre.subtechnique):c.mitre.technique,s=c.mitre.technique_name?"".concat(a," \xb7 ").concat(c.mitre.technique_name):a;t.set(a,s)}r.add(c.product),c.dataSources.forEach(e=>a.add(e)),s.add(c.severity),o.add(c.status)});let c=e=>e instanceof Map?Array.from(e.entries()).map(e=>{let[t,r]=e;return{value:t,label:r}}):Array.from(e.values()).map(e=>({value:e,label:e}));return{tactics:c(e),techniques:c(t),products:c(r),dataSources:c(a),severities:c(s),statuses:c(o)}},[m]),b=(0,s.useMemo)(()=>{let e=x.search.trim().toLowerCase();return m.filter(t=>{var r,a,s,o,c,l;let n=null!=(o=null==(r=t.mitre)?void 0:r.tactic)?o:"",i=null!=(c=null==(a=t.mitre)?void 0:a.tactic_name)?c:"",u=t.mitre?t.mitre.subtechnique?"".concat(t.mitre.technique,".").concat(t.mitre.subtechnique):t.mitre.technique:"",d=null!=(l=null==(s=t.mitre)?void 0:s.technique_name)?l:"",m=!e||t.title.toLowerCase().includes(e)||t.summary.toLowerCase().includes(e)||n.toLowerCase().includes(e)||i.toLowerCase().includes(e)||u.toLowerCase().includes(e)||d.toLowerCase().includes(e)||t.dataSources.some(t=>t.toLowerCase().includes(e)),h=!x.tactic||x.tactic===n,p=!x.technique||x.technique===u,v=!x.product||x.product===t.product,b=!x.severity||t.severity.toLowerCase()===x.severity.toLowerCase(),f=!x.status||t.status.toLowerCase()===x.status.toLowerCase(),g=!x.dataSource||t.dataSources.some(e=>e.toLowerCase()===x.dataSource.toLowerCase());return m&&h&&p&&v&&b&&f&&g})},[m,x]),f=(e,t)=>{p(r=>({...r,[e]:t}))};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"rounded-[var(--radius-lg)] border border-[color:var(--border-subtle)] bg-[color:var(--panel)] p-6",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:[(0,a.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[(0,a.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]",children:"Search"}),(0,a.jsx)("input",{type:"search",value:x.search,onChange:e=>f("search",e.target.value),placeholder:"Query detections",className:"w-full rounded-lg border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-3 py-2 text-sm text-[color:var(--text-primary)] shadow-sm transition focus:border-[color:var(--brand)] focus:outline-none"})]}),(0,a.jsx)(i,{label:"Tactic",value:x.tactic,onChange:e=>f("tactic",e),options:v.tactics,placeholder:"All tactics"}),(0,a.jsx)(i,{label:"Technique",value:x.technique,onChange:e=>f("technique",e),options:v.techniques,placeholder:"All techniques"}),(0,a.jsx)(i,{label:"Product",value:x.product,onChange:e=>f("product",e),options:v.products,placeholder:"All products"}),(0,a.jsx)(i,{label:"Data source",value:x.dataSource,onChange:e=>f("dataSource",e),options:v.dataSources,placeholder:"All data"}),(0,a.jsx)(i,{label:"Severity",value:x.severity,onChange:e=>f("severity",e),options:v.severities,placeholder:"All severities"}),(0,a.jsx)(i,{label:"Status",value:x.status,onChange:e=>f("status",e),options:v.statuses,placeholder:"All statuses"})]}),(0,a.jsxs)("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-4",children:[(0,a.jsxs)("p",{className:"text-sm text-[color:var(--text-muted)]",children:["Showing ",b.length," of ",m.length," detections",u&&" \xb7 updatingâ€¦"]}),(0,a.jsx)("button",{type:"button",onClick:()=>p(l),className:"rounded-md border border-[color:var(--border-subtle)] bg-transparent px-3 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--text-muted)] transition hover:border-[color:var(--brand)] hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]",children:"Reset filters"})]})]}),0===b.length?(0,a.jsxs)("div",{className:"rounded-[var(--radius-lg)] border border-dashed border-[color:var(--border-subtle)] bg-[color:var(--panel)] p-8 text-center",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-[color:var(--text-muted)]",children:"No detections match the current filters."}),(0,a.jsx)("p",{className:"text-xs text-[color:var(--text-subtle)]",children:"Adjust filters or clear them to explore the full catalog."})]}):(0,a.jsx)("div",{className:"grid gap-5 sm:grid-cols-2 xl:grid-cols-3",children:b.map(e=>(0,a.jsx)(c.i,{detection:e},e.slug))})]})}function i(e){let{label:t,value:r,onChange:s,options:o,placeholder:c}=e;return(0,a.jsxs)("label",{className:"flex flex-col gap-2 text-sm",children:[(0,a.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]",children:t}),(0,a.jsxs)("select",{value:r,onChange:e=>s(e.target.value),className:"w-full rounded-lg border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-3 py-2 text-sm text-[color:var(--text-primary)] transition focus:border-[color:var(--brand)] focus:outline-none",children:[(0,a.jsx)("option",{value:"",children:null!=c?c:"All"}),o.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]})]})}},5702:(e,t,r)=>{Promise.resolve().then(r.bind(r,3602))},9683:(e,t,r)=>{"use strict";r.d(t,{i:()=>i});var a=r(5155),s=r(2619),o=r.n(s),c=r(2821);function l(e){let{tone:t="default",className:r,children:s,...o}=e;return(0,a.jsx)("span",{className:(0,c.A)("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide",{"bg-[rgba(90,169,255,0.14)] text-[color:var(--brand)]":"brand"===t,"bg-[rgba(126,231,135,0.16)] text-[color:var(--brand-alt)]":"success"===t,"bg-[rgba(255,184,107,0.16)] text-[color:var(--warn)]":"warn"===t,"bg-[rgba(255,107,122,0.18)] text-[color:var(--danger)]":"danger"===t,"bg-[rgba(255,255,255,0.08)] text-[color:var(--text-muted)]":"muted"===t,"bg-[rgba(255,255,255,0.12)] text-[color:var(--text-primary)]":"default"===t},r),...o,children:s})}let n={low:"muted",medium:"warn",high:"brand",critical:"danger"};function i(e){let{detection:t,highlight:r=!1}=e;return(0,a.jsxs)(o(),{href:"/detections/".concat(t.slug),className:(0,c.A)("group flex h-full flex-col rounded-[var(--radius-lg)] border border-[color:var(--border-subtle)] bg-[color:var(--panel)] p-6 transition hover:border-[color:var(--brand)] hover:shadow-[var(--shadow-md)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]",r&&"border-[color:var(--brand)] shadow-[var(--shadow-md)]"),children:[(0,a.jsxs)("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[(0,a.jsx)(l,{tone:n[t.severity],children:t.severity.toUpperCase()}),(0,a.jsx)(l,{tone:"stable"===t.status?"success":"warn",children:t.status})]}),(0,a.jsx)("h3",{className:"mb-2 text-xl font-semibold text-[color:var(--text-primary)] transition group-hover:text-[color:var(--brand)]",children:t.title}),(0,a.jsx)("p",{className:"mb-4 text-sm text-[color:var(--text-muted)]",children:t.summary}),(0,a.jsxs)("div",{className:"mt-auto flex flex-wrap items-center gap-x-4 gap-y-2 text-xs text-[color:var(--text-subtle)]",children:[(0,a.jsx)("span",{className:"rounded-md bg-[rgba(255,255,255,0.06)] px-2 py-1 font-medium uppercase tracking-wide",children:t.product}),(0,a.jsx)("span",{children:t.queryLanguage}),(0,a.jsxs)("span",{children:["Updated ",function(e,t){let r=new Date(e);return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",...void 0}).format(r)}(t.updated)]})]})]})}}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=5702)),_N_E=e.O()}]);