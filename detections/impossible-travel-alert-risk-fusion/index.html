<!DOCTYPE html><!--hEa7dqwFZkPW_IqhuTZSp--><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/versedetect/_next/static/media/3703c28dcda155b1-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/versedetect/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/versedetect/_next/static/css/307e841d39b95885.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/versedetect/_next/static/chunks/webpack-a857a7fe851fd03c.js"/><script src="/versedetect/_next/static/chunks/4bd1b696-c023c6e3521b1417.js" async=""></script><script src="/versedetect/_next/static/chunks/255-8a6cb4fa6dfa1618.js" async=""></script><script src="/versedetect/_next/static/chunks/main-app-5ddb3cb0b61e0850.js" async=""></script><script src="/versedetect/_next/static/chunks/619-ba102abea3e3d0e4.js" async=""></script><script src="/versedetect/_next/static/chunks/app/layout-5e4fe9df604d8d8d.js" async=""></script><script src="/versedetect/_next/static/chunks/app/detections/%5Bslug%5D/page-5e70323561ac0100.js" async=""></script><meta name="next-size-adjust" content=""/><meta name="theme-color" content="#0f1114"/><title>Versedetect | Detection Engineering Notebook</title><meta name="description" content="High-fidelity threat detection and response engineering playbooks curated by Craig Glatt."/><link rel="icon" href="/versedetect/favicon.ico" type="image/x-icon" sizes="16x16"/><script src="/versedetect/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_454b5f __variable_7c1885 bg-[color:var(--bg)] text-[color:var(--text-primary)] antialiased"><div hidden=""><!--$--><!--/$--></div><a href="#main" class="sr-only focus:not-sr-only focus:absolute focus:left-4 focus:top-4 focus:z-[100] focus:rounded-md focus:bg-[color:var(--brand)] focus:px-3 focus:py-2 focus:text-sm focus:font-medium focus:text-black">Skip to content</a><div class="flex min-h-screen flex-col"><header class="sticky top-0 z-50 w-full border-b border-[color:var(--border-subtle)] bg-[color:var(--bg-translucent)]/90 backdrop-blur supports-[backdrop-filter]:bg-[color:var(--bg-translucent)]/80 transition-shadow"><div class="mx-auto flex w-full max-w-[1200px] items-center justify-between gap-4 px-4 py-4 md:px-6"><a class="group flex items-center gap-3 text-base font-semibold text-[color:var(--text-primary)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)] md:text-lg" href="/versedetect/"><span class="flex h-10 w-10 items-center justify-center rounded-xl border border-[color:var(--brand)]/35 bg-[color:var(--panel-soft)] text-lg font-bold tracking-wide transition group-hover:border-[color:var(--brand)] group-hover:text-[color:var(--brand)]">V</span><span class="tracking-tight">Versedetect</span></a><button type="button" aria-expanded="false" aria-controls="site-nav" class="flex h-10 w-11 items-center justify-center rounded-lg border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] text-[color:var(--text-muted)] transition hover:border-[color:var(--brand)] hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)] md:hidden"><span class="sr-only">Toggle navigation</span><svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M4 7h16M4 12h16M4 17h16"></path></svg></button><nav id="site-nav" class="absolute left-0 right-0 top-full origin-top border-b border-[color:var(--border-subtle)] bg-[color:var(--bg)] px-4 pb-4 md:static md:border-0 md:bg-transparent md:p-0 hidden md:block"><ul class="flex flex-col gap-2 md:flex-row md:items-center md:gap-6"><li><a class="inline-flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition hover:text-[color:var(--text-primary)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)] md:text-base text-[color:var(--text-muted)] hover:underline hover:decoration-[color:var(--brand)] hover:decoration-2 hover:underline-offset-8" href="/versedetect/">Home</a></li><li><a class="inline-flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition hover:text-[color:var(--text-primary)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)] md:text-base text-[color:var(--text-primary)] underline decoration-[color:var(--brand)] decoration-2 underline-offset-8" href="/versedetect/detections/">Detections</a></li><li><a class="inline-flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition hover:text-[color:var(--text-primary)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)] md:text-base text-[color:var(--text-muted)] hover:underline hover:decoration-[color:var(--brand)] hover:decoration-2 hover:underline-offset-8" href="/versedetect/mitre/">MITRE</a></li><li><a class="inline-flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition hover:text-[color:var(--text-primary)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)] md:text-base text-[color:var(--text-muted)] hover:underline hover:decoration-[color:var(--brand)] hover:decoration-2 hover:underline-offset-8" href="/versedetect/about/">About</a></li></ul></nav></div></header><main id="main" class="flex-1"><article class="mx-auto w-full max-w-[900px] space-y-8 px-4 py-12 md:px-6"><header class="space-y-4"><div class="flex flex-wrap items-center gap-3 text-sm text-[color:var(--text-subtle)]"><span class="rounded-md border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-2 py-1 font-medium uppercase tracking-wide">stable</span><span class="rounded-md border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-2 py-1 font-medium uppercase tracking-wide">high</span><span class="rounded-md border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-2 py-1 font-medium uppercase tracking-wide">T1078</span></div><h1 class="text-3xl font-semibold text-[color:var(--text-primary)] md:text-4xl">Impossible Travel Alert Risk Fusion</h1><p class="max-w-3xl text-base text-[color:var(--text-muted)]">Layers AbuseIPDB and IPQS intel over Defender &quot;impossible travel&quot; alerts to prioritize the sign-ins most likely tied to stolen credentials.</p><div class="flex flex-wrap gap-3"><a href="/versedetect/pdfs/Robust%20%E2%80%9CImpossible%20Travel%E2%80%9D%20in%20Splunk.pdf" class="inline-flex items-center justify-center rounded-[var(--radius-sm)] border border-[color:var(--border-subtle)] px-4 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--brand)] transition hover:border-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]">Download PDF</a></div></header><section class="grid gap-4 rounded-[var(--radius-lg)] border border-[color:var(--border-subtle)] bg-[color:var(--panel)] p-6 md:grid-cols-2"><div class="flex flex-col gap-1"><span class="text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]">Detection ID</span><span class="text-sm text-[color:var(--text-primary)]">DET-0001</span></div><div class="flex flex-col gap-1"><span class="text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]">Status</span><span class="inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide bg-[rgba(126,231,135,0.16)] text-[color:var(--brand-alt)]">stable</span></div><div class="flex flex-col gap-1"><span class="text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]">Severity</span><span class="inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide bg-[rgba(90,169,255,0.14)] text-[color:var(--brand)]">HIGH</span></div><div class="flex flex-col gap-1"><span class="text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]">Updated</span><span class="text-sm text-[color:var(--text-primary)]">Oct 20, 2025</span></div><div class="flex flex-col gap-1"><span class="text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]">Product</span><span class="text-sm text-[color:var(--text-primary)]">Splunk</span></div><div class="flex flex-col gap-1"><span class="text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]">Data sources</span><span class="text-sm text-[color:var(--text-primary)]">Microsoft Defender for Cloud Apps Alerts, Microsoft Defender for Identity Alerts, IP Reputation (AbuseIPDB, IPQS)</span></div><div class="flex flex-col gap-1"><span class="text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]">Query language</span><span class="text-sm text-[color:var(--text-primary)]">SPL</span></div><div class="flex flex-col gap-1"><span class="text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]">Author</span><span class="text-sm text-[color:var(--text-primary)]">Craig Glatt</span></div><div class="flex flex-col gap-1"><span class="text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]">ATT&amp;CK Mapping</span><span class="text-sm text-[color:var(--text-primary)]">TA0006 · Credential Access · T1078 · Valid Accounts</span></div></section><div class="overflow-hidden rounded-[var(--radius-lg)] border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] p-8 shadow-[var(--shadow-lg)]"><section class="prose prose-invert max-w-none text-[color:var(--text-primary)] prose-headings:text-[color:var(--text-primary)] prose-a:text-[color:var(--brand)] prose-strong:text-[color:var(--text-primary)] prose-code:text-[color:var(--brand)]"><h2>Why it matters</h2>
<p>Stolen credentials continue to be the most reliable entry point into cloud environments. Microsoft’s built-in alerting
fires frequently, but the fidelity is inconsistent. Adding intel-driven risk scoring pushes the true intrusions to the
top of the queue without throwing away the near-real-time alert feed your SOC already depends on.</p>
<h2>Operational flow</h2>
<ol>
<li>Pull Defender “Impossible travel activity” alerts from Splunk’s Endpoint datamodel (or replace with your native
index).</li>
<li>Normalize user and destination IP fields, then enrich with AbuseIPDB and IPQS on the fly.</li>
<li>Fuse the scores: Defender baseline + intel + VPN likelihood. Any alert that crosses the 50-point threshold bubbles to
the top with context ready for the analyst.</li>
<li>Optional: forward the result set to RBA or SOAR to auto-open high-scoring cases.</li>
</ol></section><div class="mt-8 space-y-6"><section class="overflow-hidden rounded-[var(--radius-lg)] border border-[color:var(--border-strong)] bg-[rgba(0,0,0,0.6)]"><header class="flex items-center justify-between gap-3 border-b border-[color:var(--border-subtle)] bg-[rgba(90,169,255,0.12)] px-4 py-3 text-xs font-semibold uppercase tracking-wide text-[color:var(--text-primary)]"><span>SPL Query</span><div class="flex items-center gap-2"><button type="button" class="rounded-md border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-2 py-1 text-[color:var(--text-muted)] transition hover:border-[color:var(--brand)] hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]">Copy</button><button type="button" class="rounded-md border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-2 py-1 text-[color:var(--text-muted)] transition hover:border-[color:var(--brand)] hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]">Wrap</button></div></header><pre class="max-h-[520px] overflow-auto bg-transparent p-5 text-sm text-[color:var(--text-primary)] whitespace-pre"><code class="grid gap-1 font-[var(--font-fira-code)] text-xs leading-6 md:text-sm"><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">1</span><span class="text-left text-[color:var(--text-primary)]">| tstats summariesonly=t allow_old_summaries=t dc(_raw) AS events_by_alert earliest(_time) AS earliest latest(_time) AS latest values(alert_type) AS alert_type values(alert_display_name) AS alert_display_name from datamodel=Endpoint.Endpoint_Alerts where nodename=Endpoint.Alerts (&quot;alert_type&quot;=&quot;Impossible travel activity&quot; OR alert_display_name IN (&quot;Impossible travel activity&quot;,&quot;Impossible travel&quot;))</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">2</span><span class="text-left text-[color:var(--text-primary)]">| rename Endpoint.Alerts.user AS raw_user Endpoint.Alerts.destination_ip AS dest_ip Endpoint.Alerts.risk_score AS defender_risk_score Endpoint.Alerts.alert_severity AS alert_severity Endpoint.Alerts.alert_id AS alert_id</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">3</span><span class="text-left text-[color:var(--text-primary)]">| eval user=coalesce(raw_user, user_principal_name, tostring(&#x27;Endpoint.Alerts&#x27;.userPrincipalName,&quot;&quot;), tostring(&#x27;Endpoint.Alerts&#x27;.user,&quot;&quot;))</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">4</span><span class="text-left text-[color:var(--text-primary)]">| where isnotnull(user) AND isnotnull(dest_ip)</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">5</span><span class="text-left text-[color:var(--text-primary)]">| lookup abuseipdb_all_ips ip AS dest_ip OUTPUTNEW abuseConfidenceScore AS abuse_score</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">6</span><span class="text-left text-[color:var(--text-primary)]">| ipqs ip=dest_ip</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">7</span><span class="text-left text-[color:var(--text-primary)]">| rename ipqs.vpn_and_proxy_score AS vpn_score</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">8</span><span class="text-left text-[color:var(--text-primary)]">| eval vpn_disposition=case(isnull(vpn_score),&quot;Unknown&quot;, vpn_score&gt;=75,&quot;Likely VPN/Proxy&quot;, true(),&quot;Low VPN likelihood&quot;)</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">9</span><span class="text-left text-[color:var(--text-primary)]">| eval intel_score=coalesce(abuse_score,0)</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">10</span><span class="text-left text-[color:var(--text-primary)]">| eval defender_score=coalesce(defender_risk_score,20)</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">11</span><span class="text-left text-[color:var(--text-primary)]">| eval triage_score=round(defender_score + intel_score + if(vpn_score&gt;=75,25,0),0)</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">12</span><span class="text-left text-[color:var(--text-primary)]">| where triage_score&gt;=50</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">13</span><span class="text-left text-[color:var(--text-primary)]">| eval reasons = mvappend(</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">14</span><span class="text-left text-[color:var(--text-primary)]">    if(defender_score&gt;=40,&quot;High Defender baseline&quot;,null()),</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">15</span><span class="text-left text-[color:var(--text-primary)]">    if(intel_score&gt;=40,&quot;High AbuseIPDB score&quot;,null()),</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">16</span><span class="text-left text-[color:var(--text-primary)]">    if(vpn_score&gt;=75,&quot;VPN or proxy infrastructure&quot;,null())</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">17</span><span class="text-left text-[color:var(--text-primary)]">  )</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">18</span><span class="text-left text-[color:var(--text-primary)]">| eval risk_reason=if(mvcount(reasons)&gt;0, mvjoin(mvfilter(isnotnull(reasons)),&quot;; &quot;), &quot;Impossible travel with credible IP risk&quot;)</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">19</span><span class="text-left text-[color:var(--text-primary)]">| table latest user dest_ip alert_severity defender_score abuse_score vpn_score vpn_disposition triage_score alert_id risk_reason</span></span><span class="grid grid-cols-[auto_1fr] gap-4"><span class="select-none text-right text-[color:var(--text-subtle)]">20</span><span class="text-left text-[color:var(--text-primary)]">| sort - triage_score latest</span></span></code></pre></section><details class="rounded-[var(--radius-md)] border border-[color:var(--border-subtle)] bg-[rgba(255,255,255,0.04)] p-4"><summary class="cursor-pointer text-sm font-semibold text-[color:var(--text-primary)]">How it works</summary><div class="mt-3 text-sm text-[color:var(--text-muted)]"><p>Combines the raw Defender risk score with AbuseIPDB and IPQualityScore telemetry. The search keeps the alert-centric workflow (analysts pivot from the alert_id) but enriches each record with IP reputation confidence and a VPN disposition. Analysts triage only the events that clear the blended score of 50.</p></div></details><details class="rounded-[var(--radius-md)] border border-[color:var(--border-subtle)] bg-[rgba(255,255,255,0.04)] p-4"><summary class="cursor-pointer text-sm font-semibold text-[color:var(--text-primary)]">Tuning &amp; false-positive notes</summary><div class="mt-3 text-sm text-[color:var(--text-muted)]"><ul>
<li>Tune the <code>triage_score</code> threshold upward if your AbuseIPDB baseline is noisy; 60 is typical for customers with broad
geo footprint.</li>
<li>Add allowlists for corporate VPN concentrators via <code>lookup corporate_access_ips dest_ip OUTPUT disposition</code>.   - Consider piping to Risk-Based Alerting with <code>| eval risk_object=user, risk_score=triage_score</code>.</li>
</ul></div></details></div></div><section class="space-y-4"><header><h2 class="text-xl font-semibold text-[color:var(--text-primary)]">Related detections</h2><p class="text-sm text-[color:var(--text-muted)]">Closely aligned tactics or companion detections to deploy together.</p></header><div class="grid gap-4 sm:grid-cols-2"><a class="group flex h-full flex-col rounded-[var(--radius-lg)] border border-[color:var(--border-subtle)] bg-[color:var(--panel)] p-6 transition hover:border-[color:var(--brand)] hover:shadow-[var(--shadow-md)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]" href="/versedetect/detections/impossible-travel-adjacent-pair/"><div class="mb-4 flex flex-wrap items-center gap-2"><span class="inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide bg-[rgba(90,169,255,0.14)] text-[color:var(--brand)]">HIGH</span><span class="inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide bg-[rgba(255,184,107,0.16)] text-[color:var(--warn)]">preview</span></div><h3 class="mb-2 text-xl font-semibold text-[color:var(--text-primary)] transition group-hover:text-[color:var(--brand)]">Adjacent Pair Impossible Travel Detector</h3><p class="mb-4 text-sm text-[color:var(--text-muted)]">Streams Entra sign-ins, pairs consecutive logons per user, and flags impossible travel using Haversine distance plus IP intelligence.</p><div class="mt-auto flex flex-wrap items-center gap-x-4 gap-y-2 text-xs text-[color:var(--text-subtle)]"><span class="rounded-md bg-[rgba(255,255,255,0.06)] px-2 py-1 font-medium uppercase tracking-wide">Splunk</span><span>SPL</span><span>Updated <!-- -->Oct 20, 2025</span></div></a></div></section><footer class="flex flex-wrap items-center justify-between gap-4 border-t border-[color:var(--border-subtle)] pt-6 text-sm text-[color:var(--text-subtle)]"><span>Need coverage for another technique?<!-- --> <a class="text-[color:var(--brand)] underline decoration-dotted underline-offset-4" href="https://www.linkedin.com/in/craig-glatt-8a06362" target="_blank" rel="noopener noreferrer">Reach out to Craig</a>.</span><a class="rounded-md border border-[color:var(--border-subtle)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--text-muted)] transition hover:border-[color:var(--brand)] hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]" href="/versedetect/detections/">Back to all detections</a></footer></article><!--$--><!--/$--></main><footer class="border-t border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] py-10"><div class="mx-auto flex w-full max-w-[1200px] flex-col justify-between gap-6 px-4 md:flex-row md:items-center md:px-6"><div><p class="text-base font-semibold text-[color:var(--text-primary)]">Versedetect</p><p class="max-w-xl text-sm text-[color:var(--text-muted)]">High-fidelity detection &amp; response engineering research by Craig Glatt.</p></div><div class="flex flex-wrap items-center gap-4 text-sm"><a class="rounded-md px-2 py-1 text-[color:var(--text-muted)] transition hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]" href="https://github.com/tweakn74/versedetect">GitHub</a><a class="rounded-md px-2 py-1 text-[color:var(--text-muted)] transition hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]" href="https://www.linkedin.com/in/craig-glatt-8a06362">LinkedIn</a></div></div></footer></div><script src="/versedetect/_next/static/chunks/webpack-a857a7fe851fd03c.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[2938,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"177\",\"static/chunks/app/layout-5e4fe9df604d8d8d.js\"],\"SiteHeader\"]\n3:I[9766,[],\"\"]\n4:I[8924,[],\"\"]\n5:I[2619,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"197\",\"static/chunks/app/detections/%5Bslug%5D/page-5e70323561ac0100.js\"],\"\"]\nb:I[7150,[],\"\"]\n:HL[\"/versedetect/_next/static/media/3703c28dcda155b1-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/versedetect/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/versedetect/_next/static/css/307e841d39b95885.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"hEa7dqwFZkPW-IqhuTZSp\",\"p\":\"/versedetect\",\"c\":[\"\",\"detections\",\"impossible-travel-alert-risk-fusion\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"detections\",{\"children\":[[\"slug\",\"impossible-travel-alert-risk-fusion\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/versedetect/_next/static/css/307e841d39b95885.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"scroll-smooth\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_454b5f __variable_7c1885 bg-[color:var(--bg)] text-[color:var(--text-primary)] antialiased\",\"children\":[[\"$\",\"a\",null,{\"href\":\"#main\",\"className\":\"sr-only focus:not-sr-only focus:absolute focus:left-4 focus:top-4 focus:z-[100] focus:rounded-md focus:bg-[color:var(--brand)] focus:px-3 focus:py-2 focus:text-sm focus:font-medium focus:text-black\",\"children\":\"Skip to content\"}],[\"$\",\"div\",null,{\"className\":\"flex min-h-screen flex-col\",\"children\":[[\"$\",\"$L2\",null,{}],[\"$\",\"main\",null,{\"id\":\"main\",\"className\":\"flex-1\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"mx-auto flex min-h-[60vh] w-full max-w-[600px] flex-col items-start justify-center gap-6 px-4 text-left md:px-6\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]\",\"children\":\"404 — Lost in the logs\"}],[\"$\",\"h1\",null,{\"className\":\"text-3xl font-semibold text-[color:var(--text-primary)]\",\"children\":\"We haven't engineered that detection yet.\"}],[\"$\",\"p\",null,{\"className\":\"text-sm text-[color:var(--text-muted)]\",\"children\":\"Double-check the URL or jump back to the detection library to explore what's already stable and in preview.\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap gap-3\",\"children\":[[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"rounded-[var(--radius-sm)] border border-[color:var(--brand)]/35 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--brand)] transition hover:border-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]\",\"children\":\"Home\"}],[\"$\",\"$L5\",null,{\"href\":\"/detections\",\"className\":\"rounded-[var(--radius-sm)] border border-[color:var(--border-subtle)] px-4 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--text-muted)] transition hover:border-[color:var(--brand)] hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]\",\"children\":\"Detection catalog\"}],[\"$\",\"$L5\",null,{\"href\":\"/mitre\",\"className\":\"rounded-[var(--radius-sm)] border border-[color:var(--border-subtle)] px-4 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--text-muted)] transition hover:border-[color:var(--brand)] hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]\",\"children\":\"MITRE coverage\"}]]}]]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"border-t border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] py-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto flex w-full max-w-[1200px] flex-col justify-between gap-6 px-4 md:flex-row md:items-center md:px-6\",\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"className\":\"text-base font-semibold text-[color:var(--text-primary)]\",\"children\":\"Versedetect\"}],[\"$\",\"p\",null,{\"className\":\"max-w-xl text-sm text-[color:var(--text-muted)]\",\"children\":\"High-fidelity detection \u0026 response engineering research by Craig Glatt.\"}]]}],\"$L6\"]}]}]]}]]}]}]]}],{\"children\":[\"detections\",\"$L7\",{\"children\":[[\"slug\",\"impossible-travel-alert-risk-fusion\",\"d\"],\"$L8\",{\"children\":[\"__PAGE__\",\"$L9\",{},null,false]},null,false]},null,false]},null,false],\"$La\",false]],\"m\":\"$undefined\",\"G\":[\"$b\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"d:I[4431,[],\"OutletBoundary\"]\nf:I[5278,[],\"AsyncMetadataOutlet\"]\n11:I[4431,[],\"ViewportBoundary\"]\n13:I[4431,[],\"MetadataBoundary\"]\n14:\"$Sreact.suspense\"\n"])</script><script>self.__next_f.push([1,"6:[\"$\",\"div\",null,{\"className\":\"flex flex-wrap items-center gap-4 text-sm\",\"children\":[[\"$\",\"$L5\",null,{\"href\":\"https://github.com/tweakn74/versedetect\",\"className\":\"rounded-md px-2 py-1 text-[color:var(--text-muted)] transition hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]\",\"children\":\"GitHub\"}],[\"$\",\"$L5\",null,{\"href\":\"https://www.linkedin.com/in/craig-glatt-8a06362\",\"className\":\"rounded-md px-2 py-1 text-[color:var(--text-muted)] transition hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]\",\"children\":\"LinkedIn\"}]]}]\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\n8:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\n9:[\"$\",\"$1\",\"c\",{\"children\":[\"$Lc\",null,[\"$\",\"$Ld\",null,{\"children\":[\"$Le\",[\"$\",\"$Lf\",null,{\"promise\":\"$@10\"}]]}]]}]\na:[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$L11\",null,{\"children\":\"$L12\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$L13\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$14\",null,{\"fallback\":null,\"children\":\"$L15\"}]}]}]]}]\n"])</script><script>self.__next_f.push([1,"c:[\"$\",\"article\",null,{\"className\":\"mx-auto w-full max-w-[900px] space-y-8 px-4 py-12 md:px-6\",\"children\":[[\"$\",\"header\",null,{\"className\":\"space-y-4\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-wrap items-center gap-3 text-sm text-[color:var(--text-subtle)]\",\"children\":[[\"$\",\"span\",null,{\"className\":\"rounded-md border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-2 py-1 font-medium uppercase tracking-wide\",\"children\":\"stable\"}],[\"$\",\"span\",null,{\"className\":\"rounded-md border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-2 py-1 font-medium uppercase tracking-wide\",\"children\":\"high\"}],[\"$\",\"span\",null,{\"className\":\"rounded-md border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-2 py-1 font-medium uppercase tracking-wide\",\"children\":\"T1078\"}]]}],[\"$\",\"h1\",null,{\"className\":\"text-3xl font-semibold text-[color:var(--text-primary)] md:text-4xl\",\"children\":\"Impossible Travel Alert Risk Fusion\"}],[\"$\",\"p\",null,{\"className\":\"max-w-3xl text-base text-[color:var(--text-muted)]\",\"children\":\"Layers AbuseIPDB and IPQS intel over Defender \\\"impossible travel\\\" alerts to prioritize the sign-ins most likely tied to stolen credentials.\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap gap-3\",\"children\":[[\"$\",\"a\",\"/pdfs/Robust%20%E2%80%9CImpossible%20Travel%E2%80%9D%20in%20Splunk.pdf\",{\"href\":\"/versedetect/pdfs/Robust%20%E2%80%9CImpossible%20Travel%E2%80%9D%20in%20Splunk.pdf\",\"className\":\"inline-flex items-center justify-center rounded-[var(--radius-sm)] border border-[color:var(--border-subtle)] px-4 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--brand)] transition hover:border-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]\",\"children\":\"Download PDF\"}]]}]]}],[\"$\",\"section\",null,{\"className\":\"grid gap-4 rounded-[var(--radius-lg)] border border-[color:var(--border-subtle)] bg-[color:var(--panel)] p-6 md:grid-cols-2\",\"children\":[[\"$\",\"div\",\"Detection ID\",{\"className\":\"flex flex-col gap-1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]\",\"children\":\"Detection ID\"}],[\"$\",\"span\",null,{\"className\":\"text-sm text-[color:var(--text-primary)]\",\"children\":\"DET-0001\"}]]}],[\"$\",\"div\",\"Status\",{\"className\":\"flex flex-col gap-1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]\",\"children\":\"Status\"}],[\"$\",\"span\",null,{\"className\":\"inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide bg-[rgba(126,231,135,0.16)] text-[color:var(--brand-alt)]\",\"children\":\"stable\"}]]}],[\"$\",\"div\",\"Severity\",{\"className\":\"flex flex-col gap-1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]\",\"children\":\"Severity\"}],[\"$\",\"span\",null,{\"className\":\"inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide bg-[rgba(90,169,255,0.14)] text-[color:var(--brand)]\",\"children\":\"HIGH\"}]]}],[\"$\",\"div\",\"Updated\",{\"className\":\"flex flex-col gap-1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]\",\"children\":\"Updated\"}],[\"$\",\"span\",null,{\"className\":\"text-sm text-[color:var(--text-primary)]\",\"children\":\"Oct 20, 2025\"}]]}],[\"$\",\"div\",\"Product\",{\"className\":\"flex flex-col gap-1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]\",\"children\":\"Product\"}],[\"$\",\"span\",null,{\"className\":\"text-sm text-[color:var(--text-primary)]\",\"children\":\"Splunk\"}]]}],\"$L16\",\"$L17\",\"$L18\",\"$L19\"]}],\"$L1a\",\"$L1b\",\"$L1c\"]}]\n"])</script><script>self.__next_f.push([1,"1d:I[5746,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"197\",\"static/chunks/app/detections/%5Bslug%5D/page-5e70323561ac0100.js\"],\"CodeBlock\"]\n16:[\"$\",\"div\",\"Data sources\",{\"className\":\"flex flex-col gap-1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]\",\"children\":\"Data sources\"}],[\"$\",\"span\",null,{\"className\":\"text-sm text-[color:var(--text-primary)]\",\"children\":\"Microsoft Defender for Cloud Apps Alerts, Microsoft Defender for Identity Alerts, IP Reputation (AbuseIPDB, IPQS)\"}]]}]\n17:[\"$\",\"div\",\"Query language\",{\"className\":\"flex flex-col gap-1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]\",\"children\":\"Query language\"}],[\"$\",\"span\",null,{\"className\":\"text-sm text-[color:var(--text-primary)]\",\"children\":\"SPL\"}]]}]\n18:[\"$\",\"div\",\"Author\",{\"className\":\"flex flex-col gap-1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]\",\"children\":\"Author\"}],[\"$\",\"span\",null,{\"className\":\"text-sm text-[color:var(--text-primary)]\",\"children\":\"Craig Glatt\"}]]}]\n19:[\"$\",\"div\",\"ATT\u0026CK Mapping\",{\"className\":\"flex flex-col gap-1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]\",\"children\":\"ATT\u0026CK Mapping\"}],[\"$\",\"span\",null,{\"className\":\"text-sm text-[color:var(--text-primary)]\",\"children\":\"TA0006 · Credential Access · T1078 · Valid Accounts\"}]]}]\n1e:T6f0,"])</script><script>self.__next_f.push([1,"| tstats summariesonly=t allow_old_summaries=t dc(_raw) AS events_by_alert earliest(_time) AS earliest latest(_time) AS latest values(alert_type) AS alert_type values(alert_display_name) AS alert_display_name from datamodel=Endpoint.Endpoint_Alerts where nodename=Endpoint.Alerts (\"alert_type\"=\"Impossible travel activity\" OR alert_display_name IN (\"Impossible travel activity\",\"Impossible travel\"))\n| rename Endpoint.Alerts.user AS raw_user Endpoint.Alerts.destination_ip AS dest_ip Endpoint.Alerts.risk_score AS defender_risk_score Endpoint.Alerts.alert_severity AS alert_severity Endpoint.Alerts.alert_id AS alert_id\n| eval user=coalesce(raw_user, user_principal_name, tostring('Endpoint.Alerts'.userPrincipalName,\"\"), tostring('Endpoint.Alerts'.user,\"\"))\n| where isnotnull(user) AND isnotnull(dest_ip)\n| lookup abuseipdb_all_ips ip AS dest_ip OUTPUTNEW abuseConfidenceScore AS abuse_score\n| ipqs ip=dest_ip\n| rename ipqs.vpn_and_proxy_score AS vpn_score\n| eval vpn_disposition=case(isnull(vpn_score),\"Unknown\", vpn_score\u003e=75,\"Likely VPN/Proxy\", true(),\"Low VPN likelihood\")\n| eval intel_score=coalesce(abuse_score,0)\n| eval defender_score=coalesce(defender_risk_score,20)\n| eval triage_score=round(defender_score + intel_score + if(vpn_score\u003e=75,25,0),0)\n| where triage_score\u003e=50\n| eval reasons = mvappend(\n    if(defender_score\u003e=40,\"High Defender baseline\",null()),\n    if(intel_score\u003e=40,\"High AbuseIPDB score\",null()),\n    if(vpn_score\u003e=75,\"VPN or proxy infrastructure\",null())\n  )\n| eval risk_reason=if(mvcount(reasons)\u003e0, mvjoin(mvfilter(isnotnull(reasons)),\"; \"), \"Impossible travel with credible IP risk\")\n| table latest user dest_ip alert_severity defender_score abuse_score vpn_score vpn_disposition triage_score alert_id risk_reason\n| sort - triage_score latest\n"])</script><script>self.__next_f.push([1,"1a:[\"$\",\"div\",null,{\"className\":\"overflow-hidden rounded-[var(--radius-lg)] border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] p-8 shadow-[var(--shadow-lg)]\",\"children\":[[\"$\",\"section\",null,{\"className\":\"prose prose-invert max-w-none text-[color:var(--text-primary)] prose-headings:text-[color:var(--text-primary)] prose-a:text-[color:var(--brand)] prose-strong:text-[color:var(--text-primary)] prose-code:text-[color:var(--brand)]\",\"children\":[[\"$\",\"h2\",\"h2-0\",{\"children\":\"Why it matters\"}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"Stolen credentials continue to be the most reliable entry point into cloud environments. Microsoft’s built-in alerting\\nfires frequently, but the fidelity is inconsistent. Adding intel-driven risk scoring pushes the true intrusions to the\\ntop of the queue without throwing away the near-real-time alert feed your SOC already depends on.\"}],\"\\n\",[\"$\",\"h2\",\"h2-1\",{\"children\":\"Operational flow\"}],\"\\n\",[\"$\",\"ol\",\"ol-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":\"Pull Defender “Impossible travel activity” alerts from Splunk’s Endpoint datamodel (or replace with your native\\nindex).\"}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":\"Normalize user and destination IP fields, then enrich with AbuseIPDB and IPQS on the fly.\"}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":\"Fuse the scores: Defender baseline + intel + VPN likelihood. Any alert that crosses the 50-point threshold bubbles to\\nthe top with context ready for the analyst.\"}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":\"Optional: forward the result set to RBA or SOAR to auto-open high-scoring cases.\"}],\"\\n\"]}]]}],[\"$\",\"div\",null,{\"className\":\"mt-8 space-y-6\",\"children\":[[\"$\",\"$L1d\",null,{\"code\":\"$1e\",\"language\":\"SPL\"}],\"$L1f\",\"$L20\"]}]]}]\n"])</script><script>self.__next_f.push([1,"1b:[\"$\",\"section\",null,{\"className\":\"space-y-4\",\"children\":[[\"$\",\"header\",null,{\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-xl font-semibold text-[color:var(--text-primary)]\",\"children\":\"Related detections\"}],[\"$\",\"p\",null,{\"className\":\"text-sm text-[color:var(--text-muted)]\",\"children\":\"Closely aligned tactics or companion detections to deploy together.\"}]]}],[\"$\",\"div\",null,{\"className\":\"grid gap-4 sm:grid-cols-2\",\"children\":[[\"$\",\"$L5\",\"impossible-travel-adjacent-pair\",{\"href\":\"/detections/impossible-travel-adjacent-pair\",\"className\":\"group flex h-full flex-col rounded-[var(--radius-lg)] border border-[color:var(--border-subtle)] bg-[color:var(--panel)] p-6 transition hover:border-[color:var(--brand)] hover:shadow-[var(--shadow-md)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-4 flex flex-wrap items-center gap-2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide bg-[rgba(90,169,255,0.14)] text-[color:var(--brand)]\",\"children\":\"HIGH\"}],[\"$\",\"span\",null,{\"className\":\"inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide bg-[rgba(255,184,107,0.16)] text-[color:var(--warn)]\",\"children\":\"preview\"}]]}],[\"$\",\"h3\",null,{\"className\":\"mb-2 text-xl font-semibold text-[color:var(--text-primary)] transition group-hover:text-[color:var(--brand)]\",\"children\":\"Adjacent Pair Impossible Travel Detector\"}],[\"$\",\"p\",null,{\"className\":\"mb-4 text-sm text-[color:var(--text-muted)]\",\"children\":\"Streams Entra sign-ins, pairs consecutive logons per user, and flags impossible travel using Haversine distance plus IP intelligence.\"}],[\"$\",\"div\",null,{\"className\":\"mt-auto flex flex-wrap items-center gap-x-4 gap-y-2 text-xs text-[color:var(--text-subtle)]\",\"children\":[[\"$\",\"span\",null,{\"className\":\"rounded-md bg-[rgba(255,255,255,0.06)] px-2 py-1 font-medium uppercase tracking-wide\",\"children\":\"Splunk\"}],[\"$\",\"span\",null,{\"children\":\"SPL\"}],[\"$\",\"span\",null,{\"children\":[\"Updated \",\"Oct 20, 2025\"]}]]}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"1c:[\"$\",\"footer\",null,{\"className\":\"flex flex-wrap items-center justify-between gap-4 border-t border-[color:var(--border-subtle)] pt-6 text-sm text-[color:var(--text-subtle)]\",\"children\":[[\"$\",\"span\",null,{\"children\":[\"Need coverage for another technique?\",\" \",[\"$\",\"a\",null,{\"className\":\"text-[color:var(--brand)] underline decoration-dotted underline-offset-4\",\"href\":\"https://www.linkedin.com/in/craig-glatt-8a06362\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"children\":\"Reach out to Craig\"}],\".\"]}],[\"$\",\"$L5\",null,{\"href\":\"/detections\",\"className\":\"rounded-md border border-[color:var(--border-subtle)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--text-muted)] transition hover:border-[color:var(--brand)] hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]\",\"children\":\"Back to all detections\"}]]}]\n"])</script><script>self.__next_f.push([1,"1f:[\"$\",\"details\",null,{\"className\":\"rounded-[var(--radius-md)] border border-[color:var(--border-subtle)] bg-[rgba(255,255,255,0.04)] p-4\",\"children\":[[\"$\",\"summary\",null,{\"className\":\"cursor-pointer text-sm font-semibold text-[color:var(--text-primary)]\",\"children\":\"How it works\"}],[\"$\",\"div\",null,{\"className\":\"mt-3 text-sm text-[color:var(--text-muted)]\",\"children\":[[\"$\",\"p\",\"p-0\",{\"children\":\"Combines the raw Defender risk score with AbuseIPDB and IPQualityScore telemetry. The search keeps the alert-centric workflow (analysts pivot from the alert_id) but enriches each record with IP reputation confidence and a VPN disposition. Analysts triage only the events that clear the blended score of 50.\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"20:[\"$\",\"details\",null,{\"className\":\"rounded-[var(--radius-md)] border border-[color:var(--border-subtle)] bg-[rgba(255,255,255,0.04)] p-4\",\"children\":[[\"$\",\"summary\",null,{\"className\":\"cursor-pointer text-sm font-semibold text-[color:var(--text-primary)]\",\"children\":\"Tuning \u0026 false-positive notes\"}],[\"$\",\"div\",null,{\"className\":\"mt-3 text-sm text-[color:var(--text-muted)]\",\"children\":[[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"Tune the \",[\"$\",\"code\",\"code-0\",{\"children\":\"triage_score\"}],\" threshold upward if your AbuseIPDB baseline is noisy; 60 is typical for customers with broad\\ngeo footprint.\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"Add allowlists for corporate VPN concentrators via \",[\"$\",\"code\",\"code-0\",{\"children\":\"lookup corporate_access_ips dest_ip OUTPUT disposition\"}],\".   - Consider piping to Risk-Based Alerting with \",[\"$\",\"code\",\"code-1\",{\"children\":\"| eval risk_object=user, risk_score=triage_score\"}],\".\"]}],\"\\n\"]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"12:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"2\",{\"name\":\"theme-color\",\"content\":\"#0f1114\"}]]\ne:null\n"])</script><script>self.__next_f.push([1,"21:I[622,[],\"IconMark\"]\n10:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Versedetect | Detection Engineering Notebook\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"High-fidelity threat detection and response engineering playbooks curated by Craig Glatt.\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/versedetect/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}],[\"$\",\"$L21\",\"3\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"15:\"$10:metadata\"\n"])</script></body></html>