1:"$Sreact.fragment"
2:I[2938,["619","static/chunks/619-ba102abea3e3d0e4.js","177","static/chunks/app/layout-5e4fe9df604d8d8d.js"],"SiteHeader"]
3:I[9766,[],""]
4:I[8924,[],""]
5:I[2619,["619","static/chunks/619-ba102abea3e3d0e4.js","197","static/chunks/app/detections/%5Bslug%5D/page-5e70323561ac0100.js"],""]
b:I[7150,[],""]
:HL["/versedetect/_next/static/media/3703c28dcda155b1-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/versedetect/_next/static/media/e4af272ccee01ff0-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/versedetect/_next/static/css/307e841d39b95885.css","style"]
0:{"P":null,"b":"hEa7dqwFZkPW-IqhuTZSp","p":"/versedetect","c":["","detections","impossible-travel-alert-risk-fusion",""],"i":false,"f":[[["",{"children":["detections",{"children":[["slug","impossible-travel-alert-risk-fusion","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/versedetect/_next/static/css/307e841d39b95885.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","className":"scroll-smooth","children":["$","body",null,{"className":"__variable_454b5f __variable_7c1885 bg-[color:var(--bg)] text-[color:var(--text-primary)] antialiased","children":[["$","a",null,{"href":"#main","className":"sr-only focus:not-sr-only focus:absolute focus:left-4 focus:top-4 focus:z-[100] focus:rounded-md focus:bg-[color:var(--brand)] focus:px-3 focus:py-2 focus:text-sm focus:font-medium focus:text-black","children":"Skip to content"}],["$","div",null,{"className":"flex min-h-screen flex-col","children":[["$","$L2",null,{}],["$","main",null,{"id":"main","className":"flex-1","children":["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","div",null,{"className":"mx-auto flex min-h-[60vh] w-full max-w-[600px] flex-col items-start justify-center gap-6 px-4 text-left md:px-6","children":[["$","span",null,{"className":"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]","children":"404 — Lost in the logs"}],["$","h1",null,{"className":"text-3xl font-semibold text-[color:var(--text-primary)]","children":"We haven't engineered that detection yet."}],["$","p",null,{"className":"text-sm text-[color:var(--text-muted)]","children":"Double-check the URL or jump back to the detection library to explore what's already stable and in preview."}],["$","div",null,{"className":"flex flex-wrap gap-3","children":[["$","$L5",null,{"href":"/","className":"rounded-[var(--radius-sm)] border border-[color:var(--brand)]/35 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--brand)] transition hover:border-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]","children":"Home"}],["$","$L5",null,{"href":"/detections","className":"rounded-[var(--radius-sm)] border border-[color:var(--border-subtle)] px-4 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--text-muted)] transition hover:border-[color:var(--brand)] hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]","children":"Detection catalog"}],["$","$L5",null,{"href":"/mitre","className":"rounded-[var(--radius-sm)] border border-[color:var(--border-subtle)] px-4 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--text-muted)] transition hover:border-[color:var(--brand)] hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]","children":"MITRE coverage"}]]}]]}],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}],["$","footer",null,{"className":"border-t border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] py-10","children":["$","div",null,{"className":"mx-auto flex w-full max-w-[1200px] flex-col justify-between gap-6 px-4 md:flex-row md:items-center md:px-6","children":[["$","div",null,{"children":[["$","p",null,{"className":"text-base font-semibold text-[color:var(--text-primary)]","children":"Versedetect"}],["$","p",null,{"className":"max-w-xl text-sm text-[color:var(--text-muted)]","children":"High-fidelity detection & response engineering research by Craig Glatt."}]]}],"$L6"]}]}]]}]]}]}]]}],{"children":["detections","$L7",{"children":[["slug","impossible-travel-alert-risk-fusion","d"],"$L8",{"children":["__PAGE__","$L9",{},null,false]},null,false]},null,false]},null,false],"$La",false]],"m":"$undefined","G":["$b",[]],"s":false,"S":true}
d:I[4431,[],"OutletBoundary"]
f:I[5278,[],"AsyncMetadataOutlet"]
11:I[4431,[],"ViewportBoundary"]
13:I[4431,[],"MetadataBoundary"]
14:"$Sreact.suspense"
6:["$","div",null,{"className":"flex flex-wrap items-center gap-4 text-sm","children":[["$","$L5",null,{"href":"https://github.com/tweakn74/versedetect","className":"rounded-md px-2 py-1 text-[color:var(--text-muted)] transition hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]","children":"GitHub"}],["$","$L5",null,{"href":"https://www.linkedin.com/in/craig-glatt-8a06362","className":"rounded-md px-2 py-1 text-[color:var(--text-muted)] transition hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]","children":"LinkedIn"}]]}]
7:["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}]
8:["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}]
9:["$","$1","c",{"children":["$Lc",null,["$","$Ld",null,{"children":["$Le",["$","$Lf",null,{"promise":"$@10"}]]}]]}]
a:["$","$1","h",{"children":[null,[["$","$L11",null,{"children":"$L12"}],["$","meta",null,{"name":"next-size-adjust","content":""}]],["$","$L13",null,{"children":["$","div",null,{"hidden":true,"children":["$","$14",null,{"fallback":null,"children":"$L15"}]}]}]]}]
c:["$","article",null,{"className":"mx-auto w-full max-w-[900px] space-y-8 px-4 py-12 md:px-6","children":[["$","header",null,{"className":"space-y-4","children":[["$","div",null,{"className":"flex flex-wrap items-center gap-3 text-sm text-[color:var(--text-subtle)]","children":[["$","span",null,{"className":"rounded-md border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-2 py-1 font-medium uppercase tracking-wide","children":"stable"}],["$","span",null,{"className":"rounded-md border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-2 py-1 font-medium uppercase tracking-wide","children":"high"}],["$","span",null,{"className":"rounded-md border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] px-2 py-1 font-medium uppercase tracking-wide","children":"T1078"}]]}],["$","h1",null,{"className":"text-3xl font-semibold text-[color:var(--text-primary)] md:text-4xl","children":"Impossible Travel Alert Risk Fusion"}],["$","p",null,{"className":"max-w-3xl text-base text-[color:var(--text-muted)]","children":"Layers AbuseIPDB and IPQS intel over Defender \"impossible travel\" alerts to prioritize the sign-ins most likely tied to stolen credentials."}],["$","div",null,{"className":"flex flex-wrap gap-3","children":[["$","a","/pdfs/Robust%20%E2%80%9CImpossible%20Travel%E2%80%9D%20in%20Splunk.pdf",{"href":"/versedetect/pdfs/Robust%20%E2%80%9CImpossible%20Travel%E2%80%9D%20in%20Splunk.pdf","className":"inline-flex items-center justify-center rounded-[var(--radius-sm)] border border-[color:var(--border-subtle)] px-4 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--brand)] transition hover:border-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]","children":"Download PDF"}]]}]]}],["$","section",null,{"className":"grid gap-4 rounded-[var(--radius-lg)] border border-[color:var(--border-subtle)] bg-[color:var(--panel)] p-6 md:grid-cols-2","children":[["$","div","Detection ID",{"className":"flex flex-col gap-1","children":[["$","span",null,{"className":"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]","children":"Detection ID"}],["$","span",null,{"className":"text-sm text-[color:var(--text-primary)]","children":"DET-0001"}]]}],["$","div","Status",{"className":"flex flex-col gap-1","children":[["$","span",null,{"className":"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]","children":"Status"}],["$","span",null,{"className":"inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide bg-[rgba(126,231,135,0.16)] text-[color:var(--brand-alt)]","children":"stable"}]]}],["$","div","Severity",{"className":"flex flex-col gap-1","children":[["$","span",null,{"className":"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]","children":"Severity"}],["$","span",null,{"className":"inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide bg-[rgba(90,169,255,0.14)] text-[color:var(--brand)]","children":"HIGH"}]]}],["$","div","Updated",{"className":"flex flex-col gap-1","children":[["$","span",null,{"className":"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]","children":"Updated"}],["$","span",null,{"className":"text-sm text-[color:var(--text-primary)]","children":"Oct 20, 2025"}]]}],["$","div","Product",{"className":"flex flex-col gap-1","children":[["$","span",null,{"className":"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]","children":"Product"}],["$","span",null,{"className":"text-sm text-[color:var(--text-primary)]","children":"Splunk"}]]}],"$L16","$L17","$L18","$L19"]}],"$L1a","$L1b","$L1c"]}]
1d:I[5746,["619","static/chunks/619-ba102abea3e3d0e4.js","197","static/chunks/app/detections/%5Bslug%5D/page-5e70323561ac0100.js"],"CodeBlock"]
16:["$","div","Data sources",{"className":"flex flex-col gap-1","children":[["$","span",null,{"className":"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]","children":"Data sources"}],["$","span",null,{"className":"text-sm text-[color:var(--text-primary)]","children":"Microsoft Defender for Cloud Apps Alerts, Microsoft Defender for Identity Alerts, IP Reputation (AbuseIPDB, IPQS)"}]]}]
17:["$","div","Query language",{"className":"flex flex-col gap-1","children":[["$","span",null,{"className":"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]","children":"Query language"}],["$","span",null,{"className":"text-sm text-[color:var(--text-primary)]","children":"SPL"}]]}]
18:["$","div","Author",{"className":"flex flex-col gap-1","children":[["$","span",null,{"className":"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]","children":"Author"}],["$","span",null,{"className":"text-sm text-[color:var(--text-primary)]","children":"Craig Glatt"}]]}]
19:["$","div","ATT&CK Mapping",{"className":"flex flex-col gap-1","children":[["$","span",null,{"className":"text-xs font-semibold uppercase tracking-wide text-[color:var(--text-subtle)]","children":"ATT&CK Mapping"}],["$","span",null,{"className":"text-sm text-[color:var(--text-primary)]","children":"TA0006 · Credential Access · T1078 · Valid Accounts"}]]}]
1e:T6f0,| tstats summariesonly=t allow_old_summaries=t dc(_raw) AS events_by_alert earliest(_time) AS earliest latest(_time) AS latest values(alert_type) AS alert_type values(alert_display_name) AS alert_display_name from datamodel=Endpoint.Endpoint_Alerts where nodename=Endpoint.Alerts ("alert_type"="Impossible travel activity" OR alert_display_name IN ("Impossible travel activity","Impossible travel"))
| rename Endpoint.Alerts.user AS raw_user Endpoint.Alerts.destination_ip AS dest_ip Endpoint.Alerts.risk_score AS defender_risk_score Endpoint.Alerts.alert_severity AS alert_severity Endpoint.Alerts.alert_id AS alert_id
| eval user=coalesce(raw_user, user_principal_name, tostring('Endpoint.Alerts'.userPrincipalName,""), tostring('Endpoint.Alerts'.user,""))
| where isnotnull(user) AND isnotnull(dest_ip)
| lookup abuseipdb_all_ips ip AS dest_ip OUTPUTNEW abuseConfidenceScore AS abuse_score
| ipqs ip=dest_ip
| rename ipqs.vpn_and_proxy_score AS vpn_score
| eval vpn_disposition=case(isnull(vpn_score),"Unknown", vpn_score>=75,"Likely VPN/Proxy", true(),"Low VPN likelihood")
| eval intel_score=coalesce(abuse_score,0)
| eval defender_score=coalesce(defender_risk_score,20)
| eval triage_score=round(defender_score + intel_score + if(vpn_score>=75,25,0),0)
| where triage_score>=50
| eval reasons = mvappend(
    if(defender_score>=40,"High Defender baseline",null()),
    if(intel_score>=40,"High AbuseIPDB score",null()),
    if(vpn_score>=75,"VPN or proxy infrastructure",null())
  )
| eval risk_reason=if(mvcount(reasons)>0, mvjoin(mvfilter(isnotnull(reasons)),"; "), "Impossible travel with credible IP risk")
| table latest user dest_ip alert_severity defender_score abuse_score vpn_score vpn_disposition triage_score alert_id risk_reason
| sort - triage_score latest
1a:["$","div",null,{"className":"overflow-hidden rounded-[var(--radius-lg)] border border-[color:var(--border-subtle)] bg-[color:var(--panel-soft)] p-8 shadow-[var(--shadow-lg)]","children":[["$","section",null,{"className":"prose prose-invert max-w-none text-[color:var(--text-primary)] prose-headings:text-[color:var(--text-primary)] prose-a:text-[color:var(--brand)] prose-strong:text-[color:var(--text-primary)] prose-code:text-[color:var(--brand)]","children":[["$","h2","h2-0",{"children":"Why it matters"}],"\n",["$","p","p-0",{"children":"Stolen credentials continue to be the most reliable entry point into cloud environments. Microsoft’s built-in alerting\nfires frequently, but the fidelity is inconsistent. Adding intel-driven risk scoring pushes the true intrusions to the\ntop of the queue without throwing away the near-real-time alert feed your SOC already depends on."}],"\n",["$","h2","h2-1",{"children":"Operational flow"}],"\n",["$","ol","ol-0",{"children":["\n",["$","li","li-0",{"children":"Pull Defender “Impossible travel activity” alerts from Splunk’s Endpoint datamodel (or replace with your native\nindex)."}],"\n",["$","li","li-1",{"children":"Normalize user and destination IP fields, then enrich with AbuseIPDB and IPQS on the fly."}],"\n",["$","li","li-2",{"children":"Fuse the scores: Defender baseline + intel + VPN likelihood. Any alert that crosses the 50-point threshold bubbles to\nthe top with context ready for the analyst."}],"\n",["$","li","li-3",{"children":"Optional: forward the result set to RBA or SOAR to auto-open high-scoring cases."}],"\n"]}]]}],["$","div",null,{"className":"mt-8 space-y-6","children":[["$","$L1d",null,{"code":"$1e","language":"SPL"}],"$L1f","$L20"]}]]}]
1b:["$","section",null,{"className":"space-y-4","children":[["$","header",null,{"children":[["$","h2",null,{"className":"text-xl font-semibold text-[color:var(--text-primary)]","children":"Related detections"}],["$","p",null,{"className":"text-sm text-[color:var(--text-muted)]","children":"Closely aligned tactics or companion detections to deploy together."}]]}],["$","div",null,{"className":"grid gap-4 sm:grid-cols-2","children":[["$","$L5","impossible-travel-adjacent-pair",{"href":"/detections/impossible-travel-adjacent-pair","className":"group flex h-full flex-col rounded-[var(--radius-lg)] border border-[color:var(--border-subtle)] bg-[color:var(--panel)] p-6 transition hover:border-[color:var(--brand)] hover:shadow-[var(--shadow-md)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]","children":[["$","div",null,{"className":"mb-4 flex flex-wrap items-center gap-2","children":[["$","span",null,{"className":"inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide bg-[rgba(90,169,255,0.14)] text-[color:var(--brand)]","children":"HIGH"}],["$","span",null,{"className":"inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold uppercase tracking-wide bg-[rgba(255,184,107,0.16)] text-[color:var(--warn)]","children":"preview"}]]}],["$","h3",null,{"className":"mb-2 text-xl font-semibold text-[color:var(--text-primary)] transition group-hover:text-[color:var(--brand)]","children":"Adjacent Pair Impossible Travel Detector"}],["$","p",null,{"className":"mb-4 text-sm text-[color:var(--text-muted)]","children":"Streams Entra sign-ins, pairs consecutive logons per user, and flags impossible travel using Haversine distance plus IP intelligence."}],["$","div",null,{"className":"mt-auto flex flex-wrap items-center gap-x-4 gap-y-2 text-xs text-[color:var(--text-subtle)]","children":[["$","span",null,{"className":"rounded-md bg-[rgba(255,255,255,0.06)] px-2 py-1 font-medium uppercase tracking-wide","children":"Splunk"}],["$","span",null,{"children":"SPL"}],["$","span",null,{"children":["Updated ","Oct 20, 2025"]}]]}]]}]]}]]}]
1c:["$","footer",null,{"className":"flex flex-wrap items-center justify-between gap-4 border-t border-[color:var(--border-subtle)] pt-6 text-sm text-[color:var(--text-subtle)]","children":[["$","span",null,{"children":["Need coverage for another technique?"," ",["$","a",null,{"className":"text-[color:var(--brand)] underline decoration-dotted underline-offset-4","href":"https://www.linkedin.com/in/craig-glatt-8a06362","target":"_blank","rel":"noopener noreferrer","children":"Reach out to Craig"}],"."]}],["$","$L5",null,{"href":"/detections","className":"rounded-md border border-[color:var(--border-subtle)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-[color:var(--text-muted)] transition hover:border-[color:var(--brand)] hover:text-[color:var(--brand)] focus:outline-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[color:var(--brand)]","children":"Back to all detections"}]]}]
1f:["$","details",null,{"className":"rounded-[var(--radius-md)] border border-[color:var(--border-subtle)] bg-[rgba(255,255,255,0.04)] p-4","children":[["$","summary",null,{"className":"cursor-pointer text-sm font-semibold text-[color:var(--text-primary)]","children":"How it works"}],["$","div",null,{"className":"mt-3 text-sm text-[color:var(--text-muted)]","children":[["$","p","p-0",{"children":"Combines the raw Defender risk score with AbuseIPDB and IPQualityScore telemetry. The search keeps the alert-centric workflow (analysts pivot from the alert_id) but enriches each record with IP reputation confidence and a VPN disposition. Analysts triage only the events that clear the blended score of 50."}]]}]]}]
20:["$","details",null,{"className":"rounded-[var(--radius-md)] border border-[color:var(--border-subtle)] bg-[rgba(255,255,255,0.04)] p-4","children":[["$","summary",null,{"className":"cursor-pointer text-sm font-semibold text-[color:var(--text-primary)]","children":"Tuning & false-positive notes"}],["$","div",null,{"className":"mt-3 text-sm text-[color:var(--text-muted)]","children":[["$","ul","ul-0",{"children":["\n",["$","li","li-0",{"children":["Tune the ",["$","code","code-0",{"children":"triage_score"}]," threshold upward if your AbuseIPDB baseline is noisy; 60 is typical for customers with broad\ngeo footprint."]}],"\n",["$","li","li-1",{"children":["Add allowlists for corporate VPN concentrators via ",["$","code","code-0",{"children":"lookup corporate_access_ips dest_ip OUTPUT disposition"}],".   - Consider piping to Risk-Based Alerting with ",["$","code","code-1",{"children":"| eval risk_object=user, risk_score=triage_score"}],"."]}],"\n"]}]]}]]}]
12:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","2",{"name":"theme-color","content":"#0f1114"}]]
e:null
21:I[622,[],"IconMark"]
10:{"metadata":[["$","title","0",{"children":"Versedetect | Detection Engineering Notebook"}],["$","meta","1",{"name":"description","content":"High-fidelity threat detection and response engineering playbooks curated by Craig Glatt."}],["$","link","2",{"rel":"icon","href":"/versedetect/favicon.ico","type":"image/x-icon","sizes":"16x16"}],["$","$L21","3",{}]],"error":null,"digest":"$undefined"}
15:"$10:metadata"
